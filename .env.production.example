# ==============================================================================
# SAASRESTO - Production Environment
# ==============================================================================
# ATTENTION: Ce fichier contient des placeholders pour les secrets.
# Sur le VPS, copiez ce fichier vers /opt/saasresto/.env et remplacez
# les valeurs CHANGE_ME par des valeurs réelles.
#
# Générer des secrets:
#   openssl rand -base64 32
# ==============================================================================

# -----------------------------------------------------------------------------
# Database
# -----------------------------------------------------------------------------
# En production Docker, l'URL est construite automatiquement par docker-compose
# Ces variables sont utilisées par docker-compose pour créer la DB
POSTGRES_DB=saasresto
POSTGRES_USER=saasresto
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_STRONG_PASSWORD

# Cette URL est pour référence - docker-compose la surcharge
DATABASE_URL="postgresql://saasresto:CHANGE_ME@saasresto-postgres:5432/saasresto?schema=public"

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=3000

# Domaine de base pour le routage multi-tenant
APP_BASE_DOMAIN=saasresto.isprojets.cloud

# URL publique (pour les emails, liens absolus, etc.)
APP_BASE_URL=https://saasresto.isprojets.cloud

# Variables publiques (exposées au client)
NEXT_PUBLIC_APP_BASE_DOMAIN=saasresto.isprojets.cloud
NEXT_PUBLIC_APP_URL=https://saasresto.isprojets.cloud

# -----------------------------------------------------------------------------
# Security - Cookies
# -----------------------------------------------------------------------------
# OBLIGATOIRE en production: cookies sécurisés (HTTPS only)
COOKIE_SECURE=true

# Domaine des cookies avec point initial pour partage entre sous-domaines
# Permet aux sessions de fonctionner sur demo.saasresto.isprojets.cloud, etc.
COOKIE_DOMAIN=.saasresto.isprojets.cloud

# Nom du cookie de session
SESSION_COOKIE_NAME=saasresto_session

# -----------------------------------------------------------------------------
# Security - Authentication
# -----------------------------------------------------------------------------
# Secret pour signer les tokens - OBLIGATOIRE à changer!
# Générer avec: openssl rand -base64 32
AUTH_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_32

# Durée de session en jours
SESSION_TTL_DAYS=7

# Rounds bcrypt pour le hachage des mots de passe
BCRYPT_ROUNDS=12

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# Limite de tentatives de connexion (anti-brute-force)
RATE_LIMIT_LOGIN_MAX=5
RATE_LIMIT_LOGIN_WINDOW_MS=900000

# Limite API générale
RATE_LIMIT_API_MAX=100
RATE_LIMIT_API_WINDOW_MS=900000

# -----------------------------------------------------------------------------
# File Uploads
# -----------------------------------------------------------------------------
# Répertoire des uploads (dans le conteneur Docker)
UPLOAD_DIR=/app/uploads

# Taille max des fichiers (10 MB)
MAX_FILE_SIZE=10485760

# Types de fichiers autorisés
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,image/gif

# Préfixe URL pour servir les fichiers uploadés
UPLOAD_URL_PREFIX=/uploads

# -----------------------------------------------------------------------------
# Logging & Monitoring
# -----------------------------------------------------------------------------
LOG_LEVEL=info

# Activer HSTS (déjà géré par nginx, mais peut être activé ici aussi)
ENABLE_HSTS=true

# -----------------------------------------------------------------------------
# Docker Image (utilisé par docker-compose)
# -----------------------------------------------------------------------------
# Remplacez par votre organisation/repo GHCR
SAASRESTO_IMAGE=ghcr.io/votre-org/saasresto:latest

# -----------------------------------------------------------------------------
# TLS / Certificates (utilisé par les scripts)
# -----------------------------------------------------------------------------
# Token API Hostinger pour DNS-01 challenge
# Obtenir depuis: Hostinger Dashboard > API Keys
HOSTINGER_API_TOKEN=CHANGE_ME_GET_FROM_HOSTINGER_DASHBOARD

# Email pour les notifications Let's Encrypt
CERT_EMAIL=admin@isprojets.cloud

# -----------------------------------------------------------------------------
# Backups
# -----------------------------------------------------------------------------
# Nombre de jours de rétention des backups
BACKUP_RETENTION_DAYS=14

# -----------------------------------------------------------------------------
# SMTP (Optionnel - pour reset password, notifications)
# -----------------------------------------------------------------------------
# Décommentez et configurez si vous avez besoin d'emails
# SMTP_HOST="smtp.gmail.com"
# SMTP_PORT="587"
# SMTP_SECURE="false"
# SMTP_USER="your-email@gmail.com"
# SMTP_PASS="CHANGE_ME_APP_PASSWORD"
# SMTP_FROM="your-email@gmail.com"

# -----------------------------------------------------------------------------
# Monitoring (Optionnel)
# -----------------------------------------------------------------------------
# SENTRY_DSN=https://xxx@sentry.io/xxx
